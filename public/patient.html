<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedConnect - ููุตุฉ ุงูุงุณุชุดุงุฑุงุช ุงูุทุจูุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-check-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>
    <script src="config.js"></script>
    <script src="utils.js" defer></script>
    
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal {
            display: none !important;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal.show {
            display: flex !important;
            align-items: center;
            justify-content: center;
        }
        .connection-status {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
        }
        .connected {
            background-color: #10b981;
            color: white;
        }
        .disconnected {
            background-color: #ef4444;
            color: white;
        }
        .time-slot {
            transition: all 0.2s ease;
        }
        .time-slot:hover {
            transform: scale(1.05);
        }
        .time-slot.selected {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            max-width: 400px;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            transform: translateY(-2px);
        }
        .doctor-avatar {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status connected">
    </div>

    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <!-- Back Button -->
                    <button onclick="window.location.href='index.html'" title="ุงูุนูุฏุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ" class="bg-gray-100 hover:bg-gray-200 text-gray-600 p-2 rounded-full transition-all duration-200 ml-4">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                    </button>
                    
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center ml-3">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">MedConnect</h1>
                        <p class="text-xs text-gray-500">ููุตุฉ ุงูุงุณุชุดุงุฑุงุช ุงูุทุจูุฉ</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4 space-x-reverse">
                    <button onclick="showDocumentsModal()" class="text-gray-600 hover:text-gray-900 transition-colors hidden" id="documentsButton" aria-label="ูุณุชูุฏุงุชู ุงูุทุจูุฉ" title="ูุณุชูุฏุงุชู ุงูุทุจูุฉ">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </button>
                    <button onclick="showBookingModal()" class="bg-gradient-to-r from-green-600 to-blue-600 text-white px-6 py-2 rounded-lg hover:from-green-700 hover:to-blue-700 transition-all duration-200 font-medium">
                        ุงุญุฌุฒ ููุนุฏ
                    </button>
                    <button onclick="showLoginModal()" class="text-gray-600 hover:text-gray-900 transition-colors" aria-label="ุชุณุฌูู ุงูุฏุฎูู" title="ุชุณุฌูู ุงูุฏุฎูู">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-gradient text-white py-32">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div class="text-center lg:text-right">
                    <h1 class="text-5xl md:text-7xl font-bold mb-8 fade-in leading-tight">
                        ุงุณุชุดุงุฑุงุช ุทุจูุฉ
                        <span class="block text-yellow-300">ููุซููุฉ</span>
                    </h1>
                    <p class="text-xl md:text-2xl mb-10 opacity-90 fade-in leading-relaxed">
                        ุงุญุฌุฒ ููุนุฏู ูุน ุฃูุถู ุงูุฃุทุจุงุก ุงููุชุฎุตุตูู ูู ุงูุนุฑุงู ูุงุญุตู ุนูู ุงุณุชุดุงุฑุฉ ุทุจูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                        <button onclick="showBookingModal()" class="bg-white text-blue-600 px-10 py-5 rounded-xl text-xl font-bold hover:bg-gray-100 transition-all duration-300 transform hover:scale-105 shadow-2xl fade-in">
                            ุงุญุฌุฒ ุงูุขู
                        </button>
                        <button onclick="switchTab('about')" class="border-2 border-white text-white px-10 py-5 rounded-xl text-xl font-bold hover:bg-white hover:text-blue-600 transition-all duration-300 fade-in">
                            ุชุนุฑู ุนูููุง
                        </button>
                    </div>
                </div>
                
                <div class="hidden lg:block">
                    <div class="relative">
                        <!-- Medical Icons Animation -->
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-96 h-96 relative">
                                <!-- Floating Medical Icons -->
                                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center animate-bounce">
                                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                    </svg>
                                </div>
                                
                                <div class="absolute top-1/4 right-0 w-12 h-12 bg-yellow-300 bg-opacity-30 rounded-full flex items-center justify-center animate-pulse">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                
                                <div class="absolute bottom-1/4 left-0 w-14 h-14 bg-green-300 bg-opacity-25 rounded-full flex items-center justify-center animate-bounce animate-delay-0-5s">
                                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                </div>
                                
                                <div class="absolute bottom-0 right-1/3 w-10 h-10 bg-purple-300 bg-opacity-20 rounded-full flex items-center justify-center animate-pulse animate-delay-1s">
                                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                </div>
                                
                                <!-- Central Medical Cross -->
                                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-white bg-opacity-10 rounded-3xl flex items-center justify-center backdrop-blur-sm">
                                    <div class="w-16 h-16 bg-white rounded-2xl flex items-center justify-center shadow-2xl">
                                        <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        
        <!-- Tabs Navigation -->
        <div class="flex flex-wrap justify-center mb-8 bg-white rounded-xl p-2 shadow-sm">
            <button onclick="switchTab('doctors')" id="doctorsTab" class="tab-button active px-6 py-3 rounded-lg font-medium text-sm mx-1 mb-2">
                ุงูุฃุทุจุงุก ุงููุชุงุญูู
            </button>
            <button onclick="switchTab('specialties')" id="specialtiesTab" class="tab-button px-6 py-3 rounded-lg font-medium text-sm mx-1 mb-2 text-gray-600 hover:text-gray-900">
                ุงูุชุฎุตุตุงุช
            </button>
            <button onclick="switchTab('about')" id="aboutTab" class="tab-button px-6 py-3 rounded-lg font-medium text-sm mx-1 mb-2 text-gray-600 hover:text-gray-900">
                ุนู ุงูููุตุฉ
            </button>
        </div>

        <!-- Doctors Tab -->
        <div id="doctorsContent" class="tab-content">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">ุฃุทุจุงุก ูุชุฎุตุตูู</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">
                    ุงุฎุชุฑ ูู ุจูู ุฃูุถู ุงูุฃุทุจุงุก ุงููุชุฎุตุตูู ูู ูุฎุชูู ุงููุฌุงูุงุช ุงูุทุจูุฉ
                </p>
            </div>

            <div class="max-w-4xl mx-auto mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="flex-1">
                            <label for="doctorSearch" class="sr-only">ุงูุจุญุซ ุนู ุทุจูุจ</label>
                            <input type="text" id="doctorSearch" placeholder="ุงุจุญุซ ุนู ุทุจูุจ ุจุงูุงุณู" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div class="flex-1">
                            <label for="specialtyFilter" class="sr-only">ุชุตููุฉ ุญุณุจ ุงูุชุฎุตุต</label>
                            <select id="specialtyFilter" title="ุชุตููุฉ ุญุณุจ ุงูุชุฎุตุต" class="p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">ุฌููุน ุงูุชุฎุตุตุงุช</option>
                                <!-- Specialties will be loaded dynamically -->
                            </select>
                        </div>
                        <button onclick="filterDoctors()" class="bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700 transition-colors">
                            ุจุญุซ
                        </button>
                    </div>
                </div>
            </div>

            <!-- Doctors Grid -->
            <div id="doctorsGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Doctors will be loaded dynamically from Firebase -->
                <div class="col-span-full flex justify-center items-center py-12">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                        <p class="text-gray-600">ุฌุงุฑู ุชุญููู ูุงุฆูุฉ ุงูุฃุทุจุงุก...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Specialties Tab -->
        <div id="specialtiesContent" class="tab-content hidden">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">ุงูุชุฎุตุตุงุช ุงูุทุจูุฉ</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">
                    ุชุนุฑู ุนูู ุงูุชุฎุตุตุงุช ุงููุชุงุญุฉ ูู ููุตุชูุง
                </p>
            </div>

            <div id="specialtiesGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Specialties will be loaded dynamically -->
                <div class="col-span-full flex justify-center items-center py-12">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                        <p class="text-gray-600">ุฌุงุฑู ุชุญููู ุงูุชุฎุตุตุงุช...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Tab -->
        <div id="aboutContent" class="tab-content hidden">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">ุนู ููุตุฉ MedConnect</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">
                    ููุตุฉ ุทุจูุฉ ูุชุทูุฑุฉ ุชูุฏู ุฅูู ุชุณููู ุงููุตูู ููุฑุนุงูุฉ ุงูุตุญูุฉ
                </p>
            </div>

            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-6">ูููุชูุง</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center ml-3 mt-1">
                                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <p class="text-gray-600">ุชูููุฑ ุงุณุชุดุงุฑุงุช ุทุจูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ</p>
                        </div>
                        <div class="flex items-start">
                            <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center ml-3 mt-1">
                                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <p class="text-gray-600">ุณูููุฉ ุงููุตูู ููุฃุทุจุงุก ุงููุชุฎุตุตูู</p>
                        </div>
                        <div class="flex items-start">
                            <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center ml-3 mt-1">
                                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <p class="text-gray-600">ุฃุณุนุงุฑ ููุงุณุจุฉ ููุฌููุน</p>
                        </div>
                        <div class="flex items-start">
                            <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center ml-3 mt-1">
                                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <p class="text-gray-600">ุฎุฏูุฉ ุนููุงุก ูุชููุฒุฉ</p>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl p-8 text-white">
                    <h4 class="text-xl font-bold mb-4">ุฅุญุตุงุฆูุงุช ุงูููุตุฉ</h4>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <span>ุงูุฃุทุจุงุก ุงููุณุฌููู</span>
                            <span class="font-bold text-2xl" id="doctorCount">1</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>ุงููุฑุถู ุงูุฑุงุถูู</span>
                            <span class="font-bold text-2xl">100+</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>ุงูุงุณุชุดุงุฑุงุช ุงูููุชููุฉ</span>
                            <span class="font-bold text-2xl">200+</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>ุงูุชูููู ุงูุนุงู</span>
                            <span class="font-bold text-2xl">4.8โญ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ุญุฌุฒ ููุนุฏ</h3>
                <button onclick="closeBookingModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Doctor Selection -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-3">ุงุฎุชุฑ ุงูุทุจูุจ</label>
                <div id="doctorSelection" class="space-y-3">
                    <!-- Doctor options will be loaded dynamically -->
                </div>
            </div>

            <!-- Selected Doctor Info -->
            <div id="selectedDoctorInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                <div class="flex items-center">
                    <div class="w-12 h-12 doctor-avatar rounded-full flex items-center justify-center ml-3">
                        <span class="text-white font-bold" id="selectedDoctorInitials">ุฏ.ู</span>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-bold text-gray-900" id="selectedDoctorName">ูุฑุฌู ุงุฎุชูุงุฑ ุทุจูุจ</h4>
                        <p class="text-sm text-gray-600" id="selectedDoctorSpecialty">ุงูุชุฎุตุต</p>
                    </div>
                    <div class="text-left">
                        <p class="text-lg font-bold text-blue-600"><span id="selectedDoctorFee">0</span> ุฃูู ุฏ.ุน</p>
                        <p class="text-xs text-gray-500">ุฑุณูู ุงูุงุณุชุดุงุฑุฉ</p>
                    </div>
                </div>
            </div>

            <form onsubmit="submitBooking(event)" class="space-y-6">
                <!-- Patient Selector -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุฑูุถ</label>
                    <select id="patientSelector" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" onchange="handlePatientSelection(this.value)">
                        <!-- Options will be loaded dynamically -->
                    </select>
                </div>

                <!-- Patient Info -->
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุงุณู ุงููุงูู</label>
                        <input type="text" id="patientName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูู ุงููุงุชู</label>
                        <input type="tel" id="patientPhone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุนูุฑ</label>
                        <input type="number" id="patientAge" min="1" max="120" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุฌูุณ</label>
                        <select id="patientGender" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="">ุงุฎุชุฑ ุงูุฌูุณ</option>
                            <option value="male">ุฐูุฑ</option>
                            <option value="female">ุฃูุซู</option>
                        </select>
                    </div>
                </div>

                <!-- Note: Date and time will be selected by receptionist after confirmation -->
                <div class="bg-blue-50 rounded-lg p-4 mb-6">
                    <p class="text-sm text-blue-700 font-medium">๐ ุณูุชู ุชุญุฏูุฏ ุงูููุนุฏ ูุงูููุช ูู ูุจู ุงูุงุณุชูุจุงู ุจุนุฏ ุชุฃููุฏ ุทูุจู</p>
                </div>

                <!-- Medical History -->
                <div class="bg-blue-50 rounded-lg p-6 space-y-4">
                    <h4 class="text-lg font-bold text-gray-900 mb-4">ุงููุนูููุงุช ุงูุทุจูุฉ</h4>
                    
                    <!-- Allergies -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุญุณุงุณูุฉ ูู ุงูุฃุฏููุฉ ุฃู ุงูุฃุทุนูุฉ</label>
                        <textarea id="allergies" rows="2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ุงุฐูุฑ ุฃู ุญุณุงุณูุฉ ูู ุงูุฃุฏููุฉ ุฃู ุงูุฃุทุนูุฉ (ูุซู: ุงูุจูุณูููุ ุงูููู ุงูุณูุฏุงููุ ุฅูุฎ...)"></textarea>
                        <p class="text-xs text-gray-500 mt-1">ูุฐู ุงููุนูููุงุช ูููุฉ ุฌุฏุงู ูุณูุงูุฉ ุงูุนูุงุฌ</p>
                    </div>
                    
                    <!-- Chronic Conditions -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3">ุงูุฃูุฑุงุถ ุงููุฒููุฉ</label>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="flex items-center">
                                <input type="checkbox" id="hypertension" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="hypertension" class="mr-2 text-sm text-gray-700">ุถุบุท ุงูุฏู ุงููุฑุชูุน</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="diabetes" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="diabetes" class="mr-2 text-sm text-gray-700">ุงูุณูุฑู</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="heartDisease" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="heartDisease" class="mr-2 text-sm text-gray-700">ุฃูุฑุงุถ ุงูููุจ</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="asthma" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="asthma" class="mr-2 text-sm text-gray-700">ุงูุฑุจู</label>
                            </div>
                        </div>
                        <div class="mt-3">
                            <input type="text" id="otherConditions" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ุฃูุฑุงุถ ูุฒููุฉ ุฃุฎุฑู...">
                        </div>
                    </div>
                    
                    <!-- Current Medications -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุฃุฏููุฉ ุงูุญุงููุฉ</label>
                        <textarea id="currentMedications" rows="2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ุงุฐูุฑ ุงูุฃุฏููุฉ ุงูุชู ูุชูุงูููุง ุงููุฑูุถ ุญุงููุงู..."></textarea>
                    </div>
                </div>

                <!-- Reason -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุณุจุจ ุงูุฒูุงุฑุฉ</label>
                    <textarea id="appointmentReason" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="ุงุฐูุฑ ุณุจุจ ุงูุฒูุงุฑุฉ ุฃู ุงูุฃุนุฑุงุถ..." required></textarea>
                </div>
                
                <div class="flex justify-end space-x-4 space-x-reverse pt-6 border-t">
                    <button type="button" onclick="closeBookingModal()" class="bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition-colors">
                        ุฅูุบุงุก
                    </button>
                    <button type="submit" id="bookingSubmitBtn" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors">
                        ุฅุฑุณุงู ุทูุจ ุงูุญุฌุฒ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Doctor Profile Modal -->
    <div id="doctorProfileModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ููู ุงูุทุจูุจ</h3>
                <button onclick="closeDoctorProfileModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div id="doctorProfileContent">
                <!-- Doctor profile content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-2">ุชุณุฌูู ุงูุฏุฎูู</h2>
                <p class="text-gray-600">ุงุฏุฎู ุจูุงูุงุชู ูููุตูู ูุญุณุงุจู</p>
            </div>

            <form onsubmit="handleLogin(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูู ุงููุงุชู</label>
                    <input type="tel" id="loginPhone" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                
                <!-- Phone-only authentication - no passwords needed -->
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 font-medium text-lg">
                    ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู
                </button>
            </form>

            <div class="mt-6 text-center">
                <p class="text-gray-600">ููุณ ูุฏูู ุญุณุงุจุ <button onclick="showRegisterModal()" class="text-blue-600 hover:text-blue-800 font-medium">ุณุฌู ุงูุขู</button></p>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-br from-green-600 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-2">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h2>
                <p class="text-gray-600">ุฃุฏุฎู ุจูุงูุงุชู ูุฅูุดุงุก ุญุณุงุจ</p>
            </div>

            <form onsubmit="handleRegister(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุงุณู ุงููุงูู</label>
                    <input type="text" id="registerName" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูู ุงููุงุชู</label>
                    <input type="tel" id="registerPhone" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="07XXXXXXXXX" required>
                </div>
                
                <!-- Phone-only authentication - no passwords needed -->
                
                <button type="submit" id="registerBtn" class="w-full bg-gradient-to-r from-green-600 to-blue-600 text-white py-4 px-6 rounded-lg hover:from-green-700 hover:to-blue-700 transition-all duration-200 font-medium text-lg">
                    ุฅูุดุงุก ุงูุญุณุงุจ
                </button>
            </form>

            <div class="mt-6 text-center">
                <p class="text-gray-600">ูุฏูู ุญุณุงุจ ุจุงููุนูุ <button onclick="showLoginModal()" class="text-blue-600 hover:text-blue-800 font-medium">ุณุฌู ุงูุฏุฎูู</button></p>
            </div>
        </div>
    </div>

    <!-- Phone Verification Modal -->
    <div id="phoneVerificationModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-2">ุชุฃููุฏ ุฑูู ุงููุงุชู</h2>
                <p class="text-gray-600 mb-2">ุชู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู ุฅูู</p>
                <p class="text-lg font-bold text-blue-600" id="verificationPhoneNumber"></p>
            </div>

            <form onsubmit="handlePhoneVerification(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูุฒ ุงูุชุญูู</label>
                    <div class="flex justify-center space-x-2" dir="ltr">
                        <input type="tel" maxlength="1" class="verification-input w-12 h-12 text-center text-xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" oninput="moveToNext(this, 0)" onkeydown="handleKeyDown(event, 0)">
                        <input type="tel" maxlength="1" class="verification-input w-12 h-12 text-center text-xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" oninput="moveToNext(this, 1)" onkeydown="handleKeyDown(event, 1)">
                        <input type="tel" maxlength="1" class="verification-input w-12 h-12 text-center text-xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" oninput="moveToNext(this, 2)" onkeydown="handleKeyDown(event, 2)">
                        <input type="tel" maxlength="1" class="verification-input w-12 h-12 text-center text-xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" oninput="moveToNext(this, 3)" onkeydown="handleKeyDown(event, 3)">
                        <input type="tel" maxlength="1" class="verification-input w-12 h-12 text-center text-xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" oninput="moveToNext(this, 4)" onkeydown="handleKeyDown(event, 4)">
                        <input type="tel" maxlength="1" class="verification-input w-12 h-12 text-center text-xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" oninput="moveToNext(this, 5)" onkeydown="handleKeyDown(event, 5)">
                    </div>
                </div>
                
                <button type="submit" id="verifyBtn" class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 text-white py-4 px-6 rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 font-medium text-lg">
                    ุชุฃููุฏ ุงูุฑูุฒ
                </button>
            </form>

            <div class="mt-6 text-center">
                <p class="text-gray-600 mb-2">ูู ุชุณุชูู ุงูุฑูุฒุ</p>
                <button onclick="resendVerificationCode()" id="resendBtn" class="text-blue-600 hover:text-blue-800 font-medium">
                    ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู (<span id="countdown">60</span>)
                </button>
            </div>
        </div>
    </div>

    <!-- User Appointments Modal -->
    <div id="appointmentsModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ููุงุนูุฏู</h3>
                <button onclick="closeAppointmentsModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Search Bar for Appointments -->
            <div class="mb-6">
                <input type="text" id="appointmentSearchInput" placeholder="ุงุจุญุซ ุจุงุณู ุงูุทุจูุจุ ุงูุชุฎุตุตุ ุฃู ุณุจุจ ุงูุฒูุงุฑุฉ..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>

            <div id="appointmentsContent">
                <div class="text-center py-8">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                    <p class="text-gray-600">ุฌุงุฑู ุชุญููู ููุงุนูุฏู...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Modal -->
    <div id="rescheduleModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ุฅุนุงุฏุฉ ุฌุฏููุฉ ุงูููุนุฏ</h3>
                <button onclick="closeRescheduleModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="rescheduleContent" class="space-y-6">
                <!-- Current appointment info will be loaded here -->
                <div class="bg-blue-50 rounded-lg p-4">
                    <p class="font-medium">ุงูููุนุฏ ุงูุญุงูู:</p>
                    <p id="currentAppointmentInfo" class="text-gray-700"></p>
                </div>

                <!-- New Date Selection -->
                <div>
                    <label for="rescheduleDate" class="block text-sm font-medium text-gray-700 mb-3">ุงุฎุชุฑ ุงูุชุงุฑูุฎ ุงูุฌุฏูุฏ</label>
                    <input type="date" id="rescheduleDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>

                <!-- New Time Slots -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-3">ุงุฎุชุฑ ุงูููุช ุงูุฌุฏูุฏ</label>
                    <div id="rescheduleTimeSlots" class="grid grid-cols-3 md:grid-cols-4 gap-3">
                        <!-- Time slots will be loaded here -->
                    </div>
                </div>

                <!-- Reschedule Reason -->
                <div>
                    <label for="rescheduleReason" class="block text-sm font-medium text-gray-700 mb-3">ุณุจุจ ุฅุนุงุฏุฉ ุงูุฌุฏููุฉ (ุงุฎุชูุงุฑู)</label>
                    <textarea id="rescheduleReason" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="ูุซุงู: ูุฏู ุงูุชุฒุงู ุขุฎุฑ ูู ูุฐุง ุงูููุช..."></textarea>
                </div>

                <div class="flex justify-end space-x-4 space-x-reverse pt-6 border-t">
                    <button type="button" onclick="closeRescheduleModal()" class="bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400">ุฅูุบุงุก</button>
                    <button type="button" id="rescheduleSubmitBtn" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700">
                        ุฅุฑุณุงู ุทูุจ ุฅุนุงุฏุฉ ุงูุฌุฏููุฉ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cancellation Confirmation Modal -->
    <div id="cancellationModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-lg w-full mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-2">ุชุฃููุฏ ุงูุฅูุบุงุก</h2>
                <p class="text-gray-600">ูู ุฃูุช ูุชุฃูุฏ ูู ุฑุบุจุชู ูู ุฅูุบุงุก ูุฐุง ุงูููุนุฏุ</p>
            </div>
            <div class="space-y-4">
                <div>
                    <label for="cancellationReason" class="block text-sm font-medium text-gray-700 mb-2">ุณุจุจ ุงูุฅูุบุงุก (ุงุฎุชูุงุฑู)</label>
                    <textarea id="cancellationReason" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500" placeholder="ูุซุงู: ุชุนุงุฑุถ ูู ุงูููุงุนูุฏุ ูู ุฃุนุฏ ุจุญุงุฌุฉ ููุงุณุชุดุงุฑุฉ..."></textarea>
                </div>
                <div class="flex justify-end space-x-4 space-x-reverse pt-4">
                    <button type="button" onclick="closeCancellationModal()" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300">ุชุฑุงุฌุน</button>
                    <button type="button" id="confirmCancelBtn" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ูุนูุ ุฅูุบุงุก ุงูููุนุฏ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rating Modal -->
    <div id="ratingModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-lg w-full mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-2">ุชูููู ุงูุฒูุงุฑุฉ</h2>
                <p class="text-gray-600">ุดุงุฑููุง ุฑุฃูู ุญูู ุชุฌุฑุจุชู ูุน ุงูุทุจูุจ</p>
            </div>
            <div class="space-y-6">
                <!-- Star Rating -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-3 text-center">ุชููููู ุงูุนุงู</label>
                    <div id="starRating" class="flex justify-center items-center space-x-2 space-x-reverse" data-rating="0">
                        <svg class="star w-10 h-10 text-gray-300 cursor-pointer" data-value="1" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                        <svg class="star w-10 h-10 text-gray-300 cursor-pointer" data-value="2" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                        <svg class="star w-10 h-10 text-gray-300 cursor-pointer" data-value="3" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                        <svg class="star w-10 h-10 text-gray-300 cursor-pointer" data-value="4" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                        <svg class="star w-10 h-10 text-gray-300 cursor-pointer" data-value="5" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8-2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                    </div>
                </div>
                <!-- Comment -->
                <div>
                    <label for="ratingComment" class="block text-sm font-medium text-gray-700 mb-2">ููุงุญุธุงุชู (ุงุฎุชูุงุฑู)</label>
                    <textarea id="ratingComment" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500" placeholder="ุตู ุชุฌุฑุจุชูุ ูุง ุงูุฐู ุฃุนุฌุจู ุฃู ูู ูุนุฌุจู..."></textarea>
                </div>
                <div class="flex justify-end space-x-4 space-x-reverse pt-4">
                    <button type="button" onclick="closeRatingModal()" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300">ุฅูุบุงุก</button>
                    <button type="button" id="submitRatingBtn" class="bg-yellow-500 text-white px-6 py-2 rounded-lg hover:bg-yellow-600">ุฅุฑุณุงู ุงูุชูููู</button>
                </div>
            </div>
        </div>
    </div>

    <!-- reCAPTCHA Container (hidden) -->
    <div id="recaptcha-container"></div>

    <!-- Chat Modal -->
    <div id="chatModal" class="modal">
        <div class="bg-white rounded-2xl p-0 max-w-lg w-full mx-4 h-[70vh] flex flex-col">
            <div class="flex items-center justify-between p-4 border-b">
                <h3 class="text-xl font-bold text-gray-900" id="chatModalTitle">ูุญุงุฏุซุฉ ูุน ุงูุงุณุชูุจุงู</h3>
                <button onclick="closeChatModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="chatMessages" class="flex-1 p-4 overflow-y-auto bg-gray-50 space-y-4"></div>
            <div class="p-4 border-t">
                <form id="chatForm" class="flex items-center gap-3">
                    <input type="text" id="chatMessageInput" placeholder="ุงูุชุจ ุฑุณุงูุชู..." class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                        ุฅุฑุณุงู
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Documents Modal -->
    <div id="documentsModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ูุณุชูุฏุงุชู ุงูุทุจูุฉ</h3>
                <button onclick="closeDocumentsModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Document Type Filters -->
            <div class="flex flex-wrap gap-3 mb-6">
                <button data-document-filter="all" onclick="filterDocuments('all')" class="bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium">
                    ุงููู
                </button>
                <button data-document-filter="prescription" onclick="filterDocuments('prescription')" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300">
                    ุงููุตูุงุช ุงูุทุจูุฉ <span id="prescriptionCount" class="bg-white px-2 py-1 rounded-full text-xs ml-1">0</span>
                </button>
                <button data-document-filter="lab_order" onclick="filterDocuments('lab_order')" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300">
                    ุทูุจุงุช ุงูุชุญุงููู <span id="labOrderCount" class="bg-white px-2 py-1 rounded-full text-xs ml-1">0</span>
                </button>
                <button data-document-filter="report" onclick="filterDocuments('report')" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300">
                    ุงูุชูุงุฑูุฑ ุงูุทุจูุฉ <span id="reportCount" class="bg-white px-2 py-1 rounded-full text-xs ml-1">0</span>
                </button>
            </div>
            
            <!-- Documents Grid -->
            <div id="documentsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Documents will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Document Viewer Modal -->
    <div id="documentViewerModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ุนุฑุถ ุงููุณุชูุฏ</h3>
                <button onclick="closeModal('documentViewerModal')" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div id="documentViewerContent">
                <!-- Document content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Family Management Modal -->
    <div id="familyModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">ุฅุฏุงุฑุฉ ุฃูุฑุงุฏ ุงูุนุงุฆูุฉ</h3>
                <button onclick="closeFamilyModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Active Member Badge -->
            <div id="activeMemberBadge" class="mb-6"></div>
            
            <!-- Add Family Member Button -->
            <div class="mb-6">
                <button onclick="showAddFamilyMemberModal()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium">
                    <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    ุฅุถุงูุฉ ูุฑุฏ ูู ุงูุนุงุฆูุฉ
                </button>
            </div>
            
            <!-- Family Members Grid -->
            <div id="familyMembersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Family members will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Add/Edit Family Member Modal -->
    <div id="familyMemberModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 id="familyMemberModalTitle" class="text-2xl font-bold text-gray-900">ุฅุถุงูุฉ ูุฑุฏ ูู ุงูุนุงุฆูุฉ</h3>
                <button onclick="closeModal('familyMemberModal')" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form onsubmit="event.preventDefault(); saveFamilyMember();" class="space-y-4">
                <input type="hidden" id="familyMemberId">
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุงุณู ุงููุงูู *</label>
                    <input type="text" id="memberName" required class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="ูุซุงู: ุฃุญูุฏ ูุญูุฏ">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุชุงุฑูุฎ ุงููููุงุฏ *</label>
                        <input type="date" id="memberDateOfBirth" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุฌูุณ *</label>
                        <select id="memberGender" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            <option value="male">ุฐูุฑ</option>
                            <option value="female">ุฃูุซู</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุตูุฉ ุงููุฑุงุจุฉ *</label>
                    <select id="memberRelationship" required class="w-full border border-gray-300 rounded-lg px-4 py-2">
                        <option value="spouse">ุงูุฒูุฌ/ุงูุฒูุฌุฉ</option>
                        <option value="son">ุงูุงุจู</option>
                        <option value="daughter">ุงูุงุจูุฉ</option>
                        <option value="father">ุงูุฃุจ</option>
                        <option value="mother">ุงูุฃู</option>
                        <option value="brother">ุงูุฃุฎ</option>
                        <option value="sister">ุงูุฃุฎุช</option>
                        <option value="grandfather">ุงูุฌุฏ</option>
                        <option value="grandmother">ุงูุฌุฏุฉ</option>
                        <option value="other">ุขุฎุฑ</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูู ุงููุงุชู (ุงุฎุชูุงุฑู)</label>
                    <input type="tel" id="memberPhone" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="07XXXXXXXXX">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุญุณุงุณูุฉ (ุงุฎุชูุงุฑู)</label>
                    <input type="text" id="memberAllergies" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="ูุซุงู: ุงูุจูุณูููุ ุงูููู ุงูุณูุฏุงูู">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุฃูุฑุงุถ ุงููุฒููุฉ (ุงูุตู ุจูุงุตูุฉ)</label>
                    <input type="text" id="memberChronicConditions" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="ูุซุงู: ุงูุณูุฑูุ ุถุบุท ุงูุฏู">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุฃุฏููุฉ ุงูุญุงููุฉ (ุงุฎุชูุงุฑู)</label>
                    <textarea id="memberCurrentMedications" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="ุงูุฃุฏููุฉ ุงูุชู ูุชูุงูููุง ุญุงููุงู"></textarea>
                </div>
                
                <div class="flex justify-end space-x-4 space-x-reverse pt-4">
                    <button type="button" onclick="closeModal('familyMemberModal')" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300">
                        ุฅูุบุงุก
                    </button>
                    <button type="submit" id="saveFamilyMemberBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                        ุญูุธ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="patient.js" defer></script>
    <script src="patient-documents.js?v=20251023" defer></script>
    <script src="family-management.js?v=20251023" defer></script>
</body>
</html>
